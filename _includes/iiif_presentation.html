{% capture data %}
{% for m in site.data.preloadedmanifests %}
	{ manifestUri: '{{m}}' }{% unless forloop.last %}, {% endunless %}

{% endfor %}
{% endcapture %}
<link rel='stylesheet' type='text/css' href='{{ site.baseurl }}/build/mirador/css/mirador-combined.css'>

<div id="mirador_container">
<style>#viewer {width: 100%; height: 660px; position: relative;}</style>
<div id='viewer'></div>

<script src='//projectmirador.org/demo/mirador.min.js'></script>
<script src='{{site.url}}{{site.baseurl}}/assets/js/annotationEndpoint.js'></script>

<script type='text/javascript'>

var annotations =
{
{% for anno in site.annotations %}
'{{anno.slug}}' : {{anno | jsonify}}
{% unless forloop.last %}, {% endunless %}
{% endfor %}
}
   $(function() {
     var api_server = '{{site.api_server}}'
     var origin_url = '{{site.url}}{{site.baseurl}}'
      myMiradorInstance = Mirador({
       id: 'viewer',
       data: [{{data}}],
       windowObjects: [{
           loadedManifest: '{{site.data.preloadedmanifests[0]}}',
           bottomPanelVisible: {{ page.bottom_panel | default: 'true' }}
       }],
       annotationEndpoint: { 'name':'Local Annotation Endpoint', 'module': 'LocalAnnotationEndpoint', 'options': {'server': api_server, 'allannotations' : annotations, 'origin_url': origin_url}},
			 sidePanelOptions : {
           'tocTabAvailable': true,
           'layersTabAvailable': true,
           'searchTabAvailable': true
         }
     });
   });
</script>
</div>
